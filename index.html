<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    /* --- å…¨åŸŸéŸ¿æ‡‰å¼ä½ˆå±€è¨­å®š --- */
    .app-container {
      width: 100%;
      padding: 15px;
      margin-right: auto;
      margin-left: auto;
      transition: max-width 0.3s ease;
    }

    #main-nav {
      max-width: 550px;
      margin: 0 auto;
    }

    /* å°è¦½å¡ç‰‡çš„æ¨£å¼ */
    .nav-card { 
      cursor: pointer; 
      transition: 0.3s; 
      height: 85px; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      font-weight: bold; 
      border-radius: 12px;
    }
    .nav-card:hover { 
      background-color: #f8f9fa; 
      transform: translateY(-2px); 
      box-shadow: 0 4px 12px rgba(0,0,0,0.1); 
    }
    .nav-icon { font-size: 1.8rem; margin-right: 15px; }
    .nav-text { font-size: 1.2rem; }

    /* å½ˆçª—è¦å‰‡ */
    .custom-modal-backdrop {
      display: none; 
      position: fixed; 
      top: 0; left: 0; 
      width: 100%; height: 100%; 
      background: rgba(0,0,0,0.6); 
      z-index: 9999; 
      overflow-y: auto;
    }
    
    .custom-modal-content {
      background: white;
      padding: 20px;
      border-radius: 12px;
      margin: 20px auto;
      width: 95%;
    }

    /* é›»è…¦ç‰ˆå„ªåŒ– */
    @media (min-width: 768px) {
      .app-container { max-width: 95%; }
      .custom-modal-content { width: 70%; max-width: 800px; padding: 40px; }
      
      #content-area {
        background: #fdfdfd;
        padding: 30px; 
        border-radius: 15px;
        box-shadow: 0 0 20px rgba(0,0,0,0.05);
      }
    }

    .table-responsive-custom {
      width: 100%;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      border: 1px solid #eee;
    }
    .page-section { display: none; }
  </style>
</head>
<body>
  <div class="app-container">
    
    <div id="main-nav">
      <div class="d-flex justify-content-center align-items-end mb-4">
        <h2 class="fw-bold mb-0">â›ª æ•™æœƒä¸»æ—¥å‡ºå¸­ç³»çµ±</h2>
        <a href="https://www.canva.com/design/DAHCGu-ynJs/eI1qlAREHLG-vLxNELzXxg/view?utm_content=DAHCGu-ynJs&utm_campaign=designshare&utm_medium=link2&utm_source=uniquelinks&utlId=h30d97a479b" 
           target="_blank" 
           class="text-secondary text-decoration-none ms-2 mb-1 border-bottom border-secondary pb-0" 
           style="font-size: 0.85rem;" title="æŸ¥çœ‹ç³»çµ±æ“ä½œèªªæ˜">
           ğŸ“– æ“ä½œèªªæ˜
        </a>
      </div>
      
      <div class="card nav-card text-primary border-primary shadow-sm mb-3" onclick="loadAttendancePage('å°èª')">
        <div class="d-flex align-items-center"><span class="nav-icon">ğŸ¤</span><span class="nav-text">ä¸»æ—¥é»åç³»çµ±</span></div>
      </div>
      
      <div class="card nav-card text-secondary shadow-sm mb-3" onclick="loadPage('MEMBERS')">
        <div class="d-flex align-items-center"><span class="nav-icon">ğŸ‘¥</span><span class="nav-text">æœƒå‹åå–®ç®¡ç†</span></div>
      </div>
      
      <div class="card nav-card text-success shadow-sm mb-3" onclick="loadPage('STATS')">
        <div class="d-flex align-items-center"><span class="nav-icon">ğŸ“Š</span><span class="nav-text">å‡ºå¸­çµ±è¨ˆæŸ¥è©¢</span></div>
      </div>
    </div>

    <div id="content-area" style="display:none;">
      <button class="btn btn-outline-secondary mb-3 shadow-sm" onclick="showHome()">â† å›ä¸»é¸å–®</button>
      
      <div id="page-ATTENDANCE" class="page-section"> <?!= include('attendance'); ?> </div>
      <div id="page-MEMBERS" class="page-section"> <?!= include('members'); ?> </div>
      <div id="page-STATS" class="page-section"> <?!= include('STATS'); ?> </div>
    </div>

  </div>

  <script>
    /* --- æ ¸å¿ƒè·³è½‰é‚è¼¯ --- */

    function prepareContentArea() {
      document.getElementById('main-nav').style.display = 'none';
      document.getElementById('content-area').style.display = 'block';
      const sections = document.querySelectorAll('.page-section');
      sections.forEach(sec => sec.style.display = 'none');
    }

    function showHome() {
      // å®‰å…¨æª¢æŸ¥ï¼šå¦‚æœé»åç³»çµ±çš„åœæ­¢æƒæå‡½å¼å­˜åœ¨ï¼Œå°±åŸ·è¡Œå®ƒ
      if (typeof stopScanning === "function") {
        stopScanning();
      }

      document.getElementById('main-nav').style.display = 'block';
      document.getElementById('content-area').style.display = 'none';
    }

    function loadAttendancePage(type) {
      prepareContentArea();
      document.getElementById('page-ATTENDANCE').style.display = 'block';
      if (typeof initAttendancePage === "function") {
        initAttendancePage(type);
      }
    }

    function loadPage(pageId) {
      prepareContentArea();
      const target = document.getElementById('page-' + pageId);
      if (target) {
        target.style.display = 'block';
        if (pageId === 'MEMBERS' && typeof refreshMemberTable === "function") {
          refreshMemberTable();
        }
        if (pageId === 'STATS') {
          if (typeof initStatsPage === "function") {
            initStatsPage(); 
          } else if (typeof fetchStatsData === "function") {
            fetchStatsData(); 
          }
        }
      }
    }

    // ç¢ºä¿é é¢è¼‰å…¥æ™‚åŸ·è¡Œ
    window.onload = function() {
      if (typeof initializeApp === "function") {
         initializeApp();
      }
    };
  </script>
</body>
</html>
